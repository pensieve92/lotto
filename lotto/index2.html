<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Lotto</title>

    <!-- open-color -->
    <style>
        @import 'styles/open-color.css';
    </style>
    <!-- base.css -->
    <link rel="stylesheet" type="text/css" href="styles/base.css" />

    <!-- components.css -->
    <link rel="stylesheet" type="text/css" href="styles/components/all.css" />
    <link rel="stylesheet" type="text/css" href="styles/components/Right.css" />
    <link rel="stylesheet" type="text/css" href="styles/components/Left.css" />
    <link rel="stylesheet" type="text/css" href="styles/components/Ball.css" />

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
</head>


<body>
    <div class='all'>
        <div class='left'>
            <div class="header">
                <div class="header1">
                    <div class="logo">
                        <img src="img/lotto1.png">
                    </div>
                    <div class="banAuto">
                        <div class="btn" onclick="banAuto();" value="11">반자동</div>
                    </div>
                </div>
                <div class="header2">
                    <div class="money">
                        <h2>전 재산</h2>
                        <input id='allProperty' type="text" value=5000>
                        <h2>원</h2>
                    </div>
                    <div class="hanbang">
                        <div class="btn" onclick='tangJin()'>탕진!</div>
                        <div class="btn" onclick="pasan()">파!산!</div>
                    </div>
                </div>
            </div>
            <div class="content">
                <div class="result-wrap">
                    <div class="result">
                        <div class="chonwon">
                            <div calss="alp" id="bundleLotto5_A">A</div>
                        </div>
                        <div class="chonwon">
                            <div calss="alp" id="bundleLotto5_B">B</div>
                        </div>
                        <div class="chonwon">
                            <div calss="alp" id="bundleLotto5_C">C</div>
                        </div>
                        <div class="chonwon">
                            <div calss="alp" id="bundleLotto5_D">D</div>
                        </div>
                        <div class="chonwon">
                            <div calss="alp" id="bundleLotto5_E" style="margin-right: 6.4px;">E</div>
                        </div>
                    </div>
                    <div class="abf">
                        <!-- <div class="btn">
                            이전
                        </div>
                        <div class="btn" style="margin-left: auto;">
                            다음
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
        <div class='right'>
            <div class="header"></div>
            <div class="content">
                <div class="result-wrap">
                    <div class="row">
                        <div class="numBox">01</div>
                        <div class="numBox">02</div>
                        <div class="numBox">03</div>
                        <div class="numBox">04</div>
                        <div class="numBox">05</div>
                        <div class="numBox">06</div>
                        <div class="numBox">07</div>
                    </div>
                    <div class="row">
                        <div class="numBox">08</div>
                        <div class="numBox">09</div>
                        <div class="numBox">10</div>
                        <div class="numBox">11</div>
                        <div class="numBox">12</div>
                        <div class="numBox">13</div>
                        <div class="numBox">14</div>
                    </div>
                    <div class="row">
                        <div class="numBox">15</div>
                        <div class="numBox">16</div>
                        <div class="numBox">17</div>
                        <div class="numBox">18</div>
                        <div class="numBox">19</div>
                        <div class="numBox">20</div>
                        <div class="numBox">21</div>
                    </div>
                    <div class="row">
                        <div class="numBox">22</div>
                        <div class="numBox">23</div>
                        <div class="numBox">24</div>
                        <div class="numBox">25</div>
                        <div class="numBox">26</div>
                        <div class="numBox">27</div>
                        <div class="numBox">28</div>
                    </div>
                    <div class="row">
                        <div class="numBox">29</div>
                        <div class="numBox">30</div>
                        <div class="numBox">31</div>
                        <div class="numBox">32</div>
                        <div class="numBox">33</div>
                        <div class="numBox">34</div>
                        <div class="numBox">35</div>
                    </div>
                    <div class="row">
                        <div class="numBox">36</div>
                        <div class="numBox">37</div>
                        <div class="numBox">38</div>
                        <div class="numBox">39</div>
                        <div class="numBox">40</div>
                        <div class="numBox">41</div>
                        <div class="numBox">42</div>
                    </div>
                    <div class="row last-row">
                        <div class="numBox">43</div>
                        <div class="numBox">44</div>
                        <div class="numBox">45</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <script>
        // 자동 & 반자동 선택 (초기값 auto)        
        function banAuto() {
            if ($('.banAuto .btn').text() == "자동") {
                $('.banAuto .btn').text("반자동");
            } else if ($('.banAuto .btn').text() == "반자동") {
                $('.banAuto .btn').text("자동");
            }
        }

        // 배열과 숫자를 받아서 배열을 return 하는 함수 만들기   
        //  initLottoArray 초기로또번호묶음, invst 투자금
        function generateLottoNumbers(initLottoArray, invst) {
            var lottoCnt = parseInt(invst / 1000);
            var bundleLotto5 = new Array();
            for (var i = 0; i < lottoCnt; i++) {
                // 반복문에서 돌리기 위해 변수 변경 (배열 복사 Reference 방지) ****************************************
                var initLottoArray_Use = JSON.parse(JSON.stringify(initLottoArray));
                //숫자 6개를 랜덤으로 뽑는다
                // 로또 숫자배열에서 0 ~ 44 사이의 번호를 1개 선택
                var lottoArrayA = new Array();
                for (var j = 0; j < 6; j++) {
                    var random = Math.floor(Math.random() * (initLottoArray.length - j)); // 44 -j >> 45 -j
                    var num = initLottoArray_Use[random];
                    // lottoArrayA에 하나씩 담기
                    lottoArrayA[j] = num;
                    // 담은 숫자는 전체 로또 숫자배열에서 제거
                    //autoLottoArray.slice(random, 1);
                    initLottoArray_Use.splice(random, 1);
                }
                // lottoArrayA 내림차순 정렬(b-a),  오름차순 정렬(a-b) 
                // 마지막에 꺼낼때 역순으로 나와서 내림차순 정렬한다.
                lottoArrayA.sort(function (a, b) {
                    return b - a;
                });
                // console.log(lottoArrayA);   // 한 세트 결과
                // 한 세트씩 담기
                bundleLotto5[i] = lottoArrayA;
            }
            // 5개 묶은것을 return
            return bundleLotto5;
        }

        // 숫자를 2자릿 수로 만들기 위한 함수
        function fillzero(obj, len) {
            obj = '000000000000000' + obj;
            return obj.substring(obj.length - len);
        }

        //뿌리기 함수()
        //뽑혀진 번호를 해당 div로 만들어 뿌려주기
        function showMeTheLotto(bundleLotto5_X_Class, bundleLotto5_X) {
            $('#' + bundleLotto5_X_Class + ' ~div').remove();
            for (var i = 0; i < bundleLotto5_X.length; i++) {
                var num = bundleLotto5_X[i];
                //num 2자릿수를 맞추기
                var num2 = fillzero(num, 2);
                $('#' + bundleLotto5_X_Class).after('<div class="ball ball' + num2 + '">' + num2 +
                    '</div>');
            }
        }

        //탕진 버튼 클릭 함수
        function tangJin() {
            // ball 지우기 
            $('.ball').remove();
            // 전재산 숫자정규식만들기
            var allPropertyReg = /(^[0-9]*$)/;
            var allProperty = $('#allProperty').val();

            // 전재산 로또 결과
            var allPropertyLottoResult = new Array();
            // 로또 숫자배열 - 초기화 용
            const lottoArray = [01, 02, 03, 04, 05, 06, 07, 08, 09, 10,
                11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                21, 22, 23, 24, 25, 26, 27, 28, 29, 30,
                31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
                41, 42, 43, 44, 45
            ];
            // 숫자 정규식 통과
            if (allPropertyReg.test(allProperty)) {
                // 전재산 /1000 의 몫
                var lottoCnt = parseInt(allProperty / 1000);

                // 로또 갯수 제한 1 ~ 5
                if (lottoCnt > 5) {
                    alert("전 재산 6000원 이상은 로또를 할 수 없습니다.");
                    return;
                } else if (lottoCnt < 1) {
                    alert("전 재산 1000원 미만은 로또를 할 수 없습니다.");
                    $('.ball').remove();
                }

                // 자동으로 로또 번호 추출
                if ($('.banAuto .btn').text() == "반자동") {
                    //전재산의 /1000 몫 만큼 반복
                    var bundleLotto5 = generateLottoNumbers(lottoArray, allProperty);
                    console.log(bundleLotto5);

                    // bundleLotto5 0번째 A array
                    var bundleLotto5_A = bundleLotto5[0];
                    showMeTheLotto("bundleLotto5_A", bundleLotto5_A);
                    // bundleLotto5 1번째 B
                    var bundleLotto5_B = bundleLotto5[1];
                    showMeTheLotto("bundleLotto5_B", bundleLotto5_B);
                    // bundleLotto5 2번째 C
                    var bundleLotto5_C = bundleLotto5[2];
                    showMeTheLotto("bundleLotto5_C", bundleLotto5_C);
                    // bundleLotto5 3번째 D
                    var bundleLotto5_D = bundleLotto5[3];
                    showMeTheLotto("bundleLotto5_D", bundleLotto5_D);
                    // bundleLotto5 4번째 E
                    var bundleLotto5_E = bundleLotto5[4];
                    showMeTheLotto("bundleLotto5_E", bundleLotto5_E);

                    // 반자동을 로또 번호 추출    
                } else if ($('.banAuto .btn').text() == "자동") {
                    //빨간번호 갯수 (랜덤으로 뽑을 갯수 : 6-빨간번호 갯수)
                    // 6 - $('.numBox[color="red"]').length

                    //파란번호 갯수
                    //파란번호를 빼기 위한 로또 배열 가져오기
                    var lottoArray_Use = JSON.parse(JSON.stringify(lottoArray));
                    //파란번호 담기
                    var blueCnt = $('.numBox[color="blue"]').length
                    for(var b = 0 ; b < blueCnt ; b++){
                        console.log($('.numBox[color="blue"]')[b].innerText);
                        var blueNum = lottoArray_Use.indexOf(parseInt($('.numBox[color="blue"]')[b].innerText));
                        
                        lottoArray_Use.splice(blueNum,1);
                    }
                    var bundleLotto5 = generateLottoNumbers(lottoArray_Use, allProperty);
                    console.log(bundleLotto5);

                    // bundleLotto5 0번째 A array
                    var bundleLotto5_A = bundleLotto5[0];
                    showMeTheLotto("bundleLotto5_A", bundleLotto5_A);
                    // bundleLotto5 1번째 B
                    var bundleLotto5_B = bundleLotto5[1];
                    showMeTheLotto("bundleLotto5_B", bundleLotto5_B);
                    // bundleLotto5 2번째 C
                    var bundleLotto5_C = bundleLotto5[2];
                    showMeTheLotto("bundleLotto5_C", bundleLotto5_C);
                    // bundleLotto5 3번째 D
                    var bundleLotto5_D = bundleLotto5[3];
                    showMeTheLotto("bundleLotto5_D", bundleLotto5_D);
                    // bundleLotto5 4번째 E
                    var bundleLotto5_E = bundleLotto5[4];
                    showMeTheLotto("bundleLotto5_E", bundleLotto5_E);

               

                    

                    // alert('아직 준비중입니다.');
                }
            } else {
                alert('숫자만 입력하세요')
            }
        }

        //파산 버튼 클릭 함수
        function pasan(){
             // ball 지우기 
             $('.ball').remove();

            // 클릭 번호 지우기
            $('.numBox').css('background-color', 'white');
             $('.numBox').attr('color', "")
        }

        $(function(){
            $('.numBox').bind("mousedown",function(event){       
                if(event.which == 1){
                     //클릭 허용 갯수 제한 (빨간색 최대 6개)S                    
                    if($('.numBox[color="red"]').length > 5){
                        alert('필수 번호 갯수는 6개 까지입니다.');
                        return;
                    }
                    // alert("좌클릭 : 번호 " + $(this).text());
                    $(this).css('background-color', 'var(--oc-red-4)');
                    $(this).attr('color','red');
                    // alert($(this).attr('color'))
                }else if(event.which == 2){
                    // alert("휠 클릭 : 번호 " + $(this).text());                    
                    // $(this).css('background-color', 'white');
                }else if(event.which == 3){
                    //클릭 허용 갯수 제한 (파란색 최대 39개)
                    if($('.numBox[color="blue"]').length > 38){
                        alert('제외 번호 갯수는 39개 까지입니다.');
                        return;
                    }
                    // 우클릭 메뉴 이벤트 해제
                    $(document).bind("contextmenu",function(event){
                        event.preventDefault();
                    })                    
                    // alert("우 클릭 : 번호 " + $(this).text());
                    $(this).attr('color','blue');
                    $(this).css('background-color', 'var(--oc-blue-4)');
                }                
            })
        })

    </script>
</body>

</html>